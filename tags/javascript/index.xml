<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>javascript on Trim21&#39;s Blog</title>
    <link>https://blog.trim21.me/tags/javascript/</link>
    <description>Recent content in javascript on Trim21&#39;s Blog</description>
    <generator>Hugo</generator>
    <language>zh-cn</language>
    <lastBuildDate>Tue, 11 Mar 2025 02:31:16 +0800</lastBuildDate>
    <atom:link href="https://blog.trim21.me/tags/javascript/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>在UserScript中使用Vue</title>
      <link>https://blog.trim21.me/2018/10/use-vue-in-userscript/</link>
      <pubDate>Thu, 11 Oct 2018 15:26:00 +0800</pubDate>
      <guid>https://blog.trim21.me/2018/10/use-vue-in-userscript/</guid>
      <description>&lt;p&gt;之前写了一个用户脚本, &lt;a href=&#34;https://github.com/Trim21/bgm-tv-auto-tracker&#34;&gt;在站外一键点 bgm 格子&lt;/a&gt; 为了添加一个 UI, 但又不想用 jQuery 手动绑一堆事件, 就直接上了 Vue. 所以需要用 Webpack 打包对应的 vue 文件到 userscript 里.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://blog.trim21.me/static/bd69bf14ly1fw4c4bspy5j20b10cagmq.jpg&#34; alt=&#34;效果图&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;按钮和弹出框都是 Vue 做的.&lt;/p&gt;&#xA;&lt;p&gt;因为之前一直用的是&lt;code&gt;vue-cli&lt;/code&gt;提供的 webpack 模板, 所以不太熟悉 webpack, 踩了不少坑.&lt;/p&gt;&#xA;&lt;p&gt;参考&lt;a href=&#34;https://vue-loader.vuejs.org/guide/&#34;&gt;vue-loader&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;首先在 webpack 的设置中添加一个&lt;code&gt;loader&lt;/code&gt;, 再添加一个插件&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// webpack.config.js&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;VueLoaderPlugin&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;require&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;vue-loader/lib/plugin&amp;#34;&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;module&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;exports&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;module&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;rules&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; [&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#75715e&#34;&gt;// ... other rules&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;      {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;test&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;/\.vue$/&lt;/span&gt;,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;loader&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;vue-loader&amp;#34;&lt;/span&gt;,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;options&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          &lt;span style=&#34;color:#a6e22e&#34;&gt;loaders&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#a6e22e&#34;&gt;scss&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;vue-style-loader!css-loader!postcss-loader!sass-loader&amp;#34;&lt;/span&gt;,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#75715e&#34;&gt;// &amp;lt;style lang=&amp;#34;scss&amp;#34;&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;          },&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        },&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      },&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ],&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  },&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;plugins&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; [&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;// make sure to include the plugin!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;VueLoaderPlugin&lt;/span&gt;(),&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  ],&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;};&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;然后在代码里, 参照 Vue 官方的模板, 只要初始化一个实例就能正常显示内容了.&lt;/p&gt;</description>
    </item>
    <item>
      <title>使用webpack打包userscript</title>
      <link>https://blog.trim21.me/2018/10/webpack-userscript/</link>
      <pubDate>Wed, 03 Oct 2018 11:15:35 +0800</pubDate>
      <guid>https://blog.trim21.me/2018/10/webpack-userscript/</guid>
      <description>&lt;p&gt;原本用的是 grunt 来打包 webpack, 但是 grunt 只是依赖于简单的字符串替换和拼接, 效率过低.&lt;/p&gt;&#xA;&lt;p&gt;既然 webpack 可以用来打包别的 js 文件, 那么打包一个 userscript 肯定也没什么问题, 甚至大材小用了.&lt;/p&gt;&#xA;&lt;p&gt;所以自己写了一个模板&lt;a href=&#34;https://github.com/Trim21/webpack-userscript-template&#34;&gt;webpack-userscript-template&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;因为找了一下, 发现相应的工具还是有些缺陷的.&lt;/p&gt;&#xA;&lt;p&gt;主要有两个问题:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;生成 userscript 的 meta 注释&lt;/li&gt;&#xA;&lt;li&gt;没有一个好用的 http client 库.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;所以为了自己写 userscript 爽一点, 写了两个库解决了这个问题.&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/Trim21/userscript-metadata-webpack-plugin&#34;&gt;userscript-metadata-webpack-plugin&lt;/a&gt;用来解决生成 meta 的问题&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/Trim21/axios-userscript-adapter&#34;&gt;axios-userscript-adapter&lt;/a&gt;是 axios 的一个 adapter, 用来解决进行 http 请求的问题.&lt;/p&gt;&#xA;&lt;p&gt;本来 github 上是有一个 webpack-userscript 项目的, 但是里面不知道为什么, 打包用到的是 bash, 理解不了&amp;hellip;就自己写了一个&lt;a href=&#34;https://github.com/Trim21/webpack-userscript-template&#34;&gt;webpack-userscript-template&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;使用 axios 的时候不要忘了加入 connect 的 meta&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
